proxy_cache_path /cache/steam keys_zone=steam:256m levels=1:2:2 inactive=365d;

server {
	listen 80;
	server_name ~^(content[0-9]+)\.steampowered\.com$ ~^.*\.cs\.steampowered\.com$ client-download.steampowered.com *.hsar.steampowered.com.edgesuite.net *.akamai.steamstatic.com content-origin.steampowered.com *.steamcontent.com;

	access_log /var/log/nginx/steam-access.log;
	error_log /var/log/nginx/steam-error.log error;

	location ~ ^/(depot|client.+\.zip.*$) {
		proxy_cache steam;
		proxy_cache_key "steam $uri$slice_range"; # $is_args$args
		proxy_pass http://$host;
	}

	location / {
		proxy_pass http://$host;
	}
}
